## Using U-Net Architecture and Pytorch for Lane Tracking ##
GASimple Dataset: https://drive.google.com/drive/folders/1sIjtlCznTdaJPD6Bj8AmNTONo-9FYofB?usp=sharing

Trained Models: https://drive.google.com/drive/folders/1A4almdOVmG5t84AJhAa9CyAHYYnzCOAo?usp=sharing

## The file structure ##
--zece/
	--another_main.py	**training code. The difference with "main.py" is that this code calculates the dice score (dice score is between 0 and 1. The closer the dice score is to 1 the better.)
	--carvana_dataset.py  **dataset setup code
	--check.ME             ** you must have numpy and torch libraries, so CHECK IT!
	--empty_cuda.py		** for emptying cuda
	--img_processing.py	** this is a trial code if you want run it.
	--inference.py         **this code is for testing the trained model
	--main.py		**training code
	--try_torch.py		** checking torch
	--unet.py		**unet architecture is here
	--unet_parts.py		** Necessary unet parts are here(UpSample, DownSample, DoubleConvolution layers in it).
	--backup/               ** Trained models are here
		backup.pth_epoch1.pth
		backup.pth_epoch2.pth
		backup.pth_epoch3.pth
		backup.pth_epoch4.pth
		backup.pth_epoch5.pth
		unet.pth
	backup/
	
	--data/                    **example images and masks for evulateing the model
		images/--/
		masks/--/
	data/
	
	--GASimple/			** GA(ca)Simple Dataset
		images/--/
		masks/--/
	GASimple/
	
	--__pycache__/			**acsually i dont know what it is
		carvana_dataset.cpython-39.pyc
		unet.cpython-39.pyc
		unet_parts.cpython-39.pyc
	__pycache__/
	
	--view/ --here-- view/
zece/	

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

## FIRST TRAINING WITH GASIMPLE DATASET ## 
	
## The output on the terminal screen at the end of the training ##

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

(base) nvidia@nvidia:~/Desktop/zece$ python3 another_main.py 
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [1:16:13<00:00, 32.67s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:26<00:00, 11.05s/it]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:26<00:00, 10.26s/it]
Train Loss EPOCH 1: 0.1913
Valid Loss EPOCH 1: 0.1451
Dice Score EPOCH 1: 0.0268
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch1.pth
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [1:36:25<00:00, 41.33s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:24<00:00, 10.97s/it]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:24<00:00, 10.25s/it]
Train Loss EPOCH 2: 0.1024
Valid Loss EPOCH 2: 0.0798
Dice Score EPOCH 2: 0.4884
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch2.pth
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [1:26:58<00:00, 37.28s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:23<00:00, 10.97s/it]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:23<00:00, 10.24s/it]
Train Loss EPOCH 3: 0.0688
Valid Loss EPOCH 3: 0.0592
Dice Score EPOCH 3: 0.7022
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch3.pth
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [1:28:38<00:00, 37.99s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:26<00:00, 11.03s/it]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:26<00:00, 10.29s/it]
Train Loss EPOCH 4: 0.0555
Valid Loss EPOCH 4: 0.0512
Dice Score EPOCH 4: 0.7231
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch4.pth
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 140/140 [1:34:10<00:00, 40.36s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:26<00:00, 11.03s/it]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [06:26<00:00, 10.29s/it]
Train Loss EPOCH 5: 0.0499
Valid Loss EPOCH 5: 0.0510
Dice Score EPOCH 5: 0.7187
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch5.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [7:54:33<00:00, 5694.68s/it]

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	
Thats not a good result but its okay for now. (this is my first experience with pytorch...:)



---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

## SECOND TRAİNİNG WITH SAME DATASET ##

## The output on the terminal screen at the end of the SECOND training ## train with RTX A4000

(base) nvidia@nvidia:~/Desktop/zece$ python3 another_main.py
100%|█████████████████████████████████████████| 279/279 [02:48<00:00,  1.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:22<00:00,  3.17it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:22<00:00,  3.71it/s]
Train Loss EPOCH 1: 0.1686
Valid Loss EPOCH 1: 0.0990
Dice Score EPOCH 1: 0.4839
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch1.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 279/279 [02:52<00:00,  1.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:21<00:00,  3.33it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:21<00:00,  3.91it/s]
Train Loss EPOCH 2: 0.0755
Valid Loss EPOCH 2: 0.0741
Dice Score EPOCH 2: 0.6499
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch2.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 279/279 [02:52<00:00,  1.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.34it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.91it/s]
Train Loss EPOCH 3: 0.0571
Valid Loss EPOCH 3: 0.0530
Dice Score EPOCH 3: 0.7146
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch3.pth
 30%|████████████▉                              | 3/10 [09:36<22:28, 192.60s/it]
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                             80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                            81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                         81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ /s]100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:21<00:00,  3.32it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:21<00:00,  3.89it/s]
Train Loss EPOCH 4: 0.0498
Valid Loss EPOCH 4: 0.0466
Dice Score EPOCH 4: 0.7549
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch4.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 279/279 [02:52<00:00,  1.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:21<00:00,  3.33it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:21<00:00,  3.90it/s]
Train Loss EPOCH 5: 0.0465
Valid Loss EPOCH 5: 0.0438
Dice Score EPOCH 5: 0.7747
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch5.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 279/279 [02:52<00:00,  1.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:21<00:00,  3.32it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:21<00:00,  3.90it/s]
Train Loss EPOCH 6: 0.0444
Valid Loss EPOCH 6: 0.0450
Dice Score EPOCH 6: 0.7504
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch6.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 279/279 [02:52<00:00,  1.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.34it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.93it/s]
Train Loss EPOCH 7: 0.0427
Valid Loss EPOCH 7: 0.0434
Dice Score EPOCH 7: 0.7711
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch7.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 279/279 [02:51<00:00,  1.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.35it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.93it/s]
Train Loss EPOCH 8: 0.0412
Valid Loss EPOCH 8: 0.0422
Dice Score EPOCH 8: 0.7748
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch8.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 279/279 [02:51<00:00,  1.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.36it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.92it/s]
Train Loss EPOCH 9: 0.0402
Valid Loss EPOCH 9: 0.0424
Dice Score EPOCH 9: 0.7697
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch9.pth
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 279/279 [02:51<00:00,  1.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.35it/s]
------------------------------█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:20<00:00,  3.92it/s]
Train Loss EPOCH 10: 0.0391
Valid Loss EPOCH 10: 0.0421
Dice Score EPOCH 10: 0.7792
------------------------------
Model saved at /home/nvidia/Desktop/zece/backup.pth_epoch10.pth
100%|██████████████████████████████████████████| 10/10 [32:15<00:00, 193.51s/it]

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


**This training was much better and shorter.

**As seen in the first training, each epoch lasted around 1 and a half hours, meaning the previous training lasted approximately 8 hours. 

**In this training, each epoch lasted an average of 3 minutes, meaning the training lasted 32 minutes.

**16 times faster than initial training

## Compare videos "output_video2_first_epoch5.avi" and "output_video2_epoch_10.avi" in the ./data/output-videos/ folder to get a concrete picture of the accuracy rates between the first training and the second training. ##




## If you want to try the model, run the inference.py code ##


## References

##https://arxiv.org/pdf/1505.04597

##https://medium.com/@fernandopalominocobo/mastering-u-net-a-step-by-step-guide-to-segmentation-from-scratch-with-pytorch-6a17c5916114

##https://youtu.be/HS3Q_90hnDg?si=lBw2dCg4fTWq0H7Q

##https://github.com/uygarkurt/UNet-PyTorch

##https://arxiv.org/abs/1505.04597


image:
![0530_1492626704820890456_0](https://github.com/user-attachments/assets/0a5a89bf-6350-4e3b-99b5-d5c9776a0ebb)

output:
![0530_1492626704820890456_0](https://github.com/user-attachments/assets/136f1535-52f1-4679-873f-e22c62ee6f07)

image:
![0530_1492722380083241850_0](https://github.com/user-attachments/assets/250f1f5e-d18c-421b-8a2e-52bf1c4a6aae)

output:
![0530_1492722380083241850_0](https://github.com/user-attachments/assets/4db5e5dc-82a6-48f7-9fc8-4e4fa7d60ef7)
